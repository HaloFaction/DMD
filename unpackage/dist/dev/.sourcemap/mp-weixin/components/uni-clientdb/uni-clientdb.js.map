{"version":3,"sources":["webpack:///G:/HBuilderProjects/projectGT-master/components/uni-clientdb/uni-clientdb.vue?84bb","webpack:///G:/HBuilderProjects/projectGT-master/components/uni-clientdb/uni-clientdb.vue?340f","webpack:///G:/HBuilderProjects/projectGT-master/components/uni-clientdb/uni-clientdb.vue?3a19","webpack:///G:/HBuilderProjects/projectGT-master/components/uni-clientdb/uni-clientdb.vue?e9cf","uni-app:///components/uni-clientdb/uni-clientdb.vue"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAyH;AACzH;AACgE;AACL;;;AAG3D;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,uFAAM;AACR,EAAE,gGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAymB,CAAgB,snBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACO7nB;AACA;;AAEA;AACA,cADA;AAEA,gBAFA;;AAIA;AACA,YADA;AAEA,oBAFA;;;AAKA;AACA,aADA;AAEA,UAFA;AAGA,YAHA;AAIA,QAJA;AAKA,OALA;AAMA,UANA;AAOA,SAPA;AAQA,OARA;;;AAWA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA,qBADA;AAEA;AACA;AACA,2BADA;AAEA,aAFA,sBAEA;AACA;AACA,OAJA,EADA;;AAOA;AACA,kBADA;AAEA,iBAFA,EAPA;;AAWA;AACA,kBADA;AAEA,iBAFA,EAXA;;AAeA;AACA,kBADA;AAEA,iBAFA,EAfA;;AAmBA;AACA,kBADA;AAEA,oBAFA,EAnBA;;AAuBA;AACA,kBADA;AAEA,gBAFA,EAvBA;;AA2BA;AACA,kBADA;AAEA,iBAFA,EA3BA;;AA+BA;AACA,6BADA;AAEA,oBAFA,EA/BA;;AAmCA;AACA,kBADA;AAEA,iBAFA,EAnCA;;AAuCA;AACA,4BADA;AAEA,iBAFA,EAvCA;;AA2CA;AACA,6BADA;AAEA,oBAFA,EA3CA;;AA+CA;AACA,mBADA;AAEA,oBAFA,EA/CA,EAFA;;;AAsDA,MAtDA,kBAsDA;AACA;AACA,oBADA;AAEA,qCAFA;AAGA;AACA,iCADA;AAEA,2BAFA;AAGA,gBAHA,EAHA;;AAQA,sBARA;;AAUA,GAjEA;AAkEA,SAlEA,qBAkEA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAFA;AAGA;AACA,KANA,EAMA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAzBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;AACA;AACA;AACA,GA3IA;;;;;;;;;;;;;;;AA0JA;AACA,YADA,oBACA,KADA,EACA,KADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAXA,MAWA;AACA;AACA;;AAEA;AACA,KAnBA;AAoBA,YApBA,sBAoBA;AACA;AACA;AACA;AACA;AACA,KAzBA;AA0BA,WA1BA,qBA0BA;AACA;AACA;AACA,KA7BA;AA8BA,SA9BA,mBA8BA;AACA;AACA;AACA,KAjCA;AAkCA,SAlCA,mBAkCA;AACA;AACA,KApCA;AAqCA,UArCA,kBAqCA,EArCA;;;;;AA0CA,yGAJA,MAIA,QAJA,MAIA,CAHA,QAGA,QAHA,QAGA,CAFA,YAEA,QAFA,YAEA,CADA,cACA,QADA,cACA;AACA;AACA;AACA;AACA;AACA,mCADA;AAEA,4CAFA;AAGA,wBAHA;AAIA;AACA;AACA;AACA;AACA;AACA,SATA;;AAWA,KAzDA;AA0DA,iBA1DA,yBA0DA,QA1DA,EA0DA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+BADA;;;;AAKA,kBALA,CAGA,IAHA,eAGA,IAHA,CAIA,KAJA,eAIA,KAJA;AAMA;;AAEA;AACA;;AAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA;AACA,SALA,MAKA;AACA;AACA;AACA;;;;;;;;AAQA,OA7BA,EA6BA,KA7BA,CA6BA;AACA;AACA;AACA;AACA;AACA,OAlCA;AAmCA,KApGA;AAqGA,YArGA,sBAqGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAhBA;;;;;AAqBA,6BArBA,CAmBA,OAnBA,yBAmBA,OAnBA,CAoBA,IApBA,yBAoBA,IApBA;AAsBA;AACA,+BADA;;;AAIA;AACA,KAhIA;AAiIA,eAjIA,uBAiIA,EAjIA,EAiIA,MAjIA,EAiIA,QAjIA,EAiIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,kBADA;;;AAIA;AACA;AACA;AACA;;AAEA;AACA,0BADA;AAEA,YAFA,GAEA,IAFA,CAEA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OATA,EASA,KATA,CASA;AACA;AACA,8BADA;AAEA,2BAFA;;AAIA,OAdA,EAcA,OAdA,CAcA;AACA;AACA,OAhBA;AAiBA,KArKA;AAsKA,cAtKA,sBAsKA,GAtKA,EAsKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAhLA;AAiLA,kBAjLA,0BAiLA,IAjLA,EAiLA,IAjLA,EAiLA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAvLA,EA1JA,E","file":"components/uni-clientdb/uni-clientdb.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./uni-clientdb.vue?vue&type=template&id=e6870178&\"\nvar renderjs\nimport script from \"./uni-clientdb.vue?vue&type=script&lang=js&\"\nexport * from \"./uni-clientdb.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/uni-clientdb/uni-clientdb.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-clientdb.vue?vue&type=template&id=e6870178&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-clientdb.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./uni-clientdb.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<slot :options=\"options\" :data=\"dataList\" :pagination=\"paginationInternal\" :loading=\"loading\" :error=\"errorMessage\"></slot>\n\t</view>\n</template>\n\n<script>\n\tconst db = uniCloud.database();\n\tconst dbCmd = db.command;\n\n\tconst events = {\n\t\tload: 'load',\n\t\terror: 'error'\n\t}\n\tconst pageMode = {\n\t\tadd: 'add',\n\t\treplace: 'replace'\n\t}\n\n\tconst attrs = [\n\t\t'pageCurrent',\n\t\t'pageSize',\n\t\t'collection',\n\t\t'action',\n\t\t'field',\n\t\t'getcount',\n\t\t'orderby',\n\t\t'where'\n\t]\n\n\t/**\n\t * uni-clientdb\n\t * @description uni-clientdb是一个数据库查询组件，它是对uni-clientdb的js库的再封装。\n\t * @tutorial https://uniapp.dcloud.net.cn/uniCloud/uni-clientdb-component\n\t * @property {String} collection 表名\n\t * @property {String} action 云端执行数据库查询的前或后，触发某个action函数操作，进行预处理或后处理\n\t * @property {String} field 查询字段，多个字段用 `,` 分割\n\t * @property {String} orderby 排序字段及正序倒叙设置\n\t * @property {String} where 查询条件\n\t * @property {String} pageData = [add|replace] `add` 多次查询的集合, `replace` 当前查询的集合\n\t * @value add 多次查询的集合\n\t * @value replace 当前查询的集合\n\t * @property {Number} pageCurrent 当前页\n\t * @property {Number} pageSize 每页数据数量\n\t * @property {Boolean} getone = [true|false] 指定查询结果是否返回数组第一条数据，默认 false。在false情况下返回的是数组，即便只有一条结果，也需要[0]的方式获取。在true下，直接返回结果数据，少一层数组\n\t * @value true 返回数组第一条数据\n\t * @value false 返回类型是数组，即便只有一条结果\n\t * @property {Boolean} getcount 是否查询总数量\n\t * @property {Boolean} manual 是否手动加载数据，默认为 false，页面onready时自动联网加载数据\n\t * @value true 开启后需要手动加载数据\n\t * @value false 页面onready时自动联网加载数据\n\t * @event {Function} load 成功回调。如联网返回结果后，想修改下数据再渲染界面，则在本方法里对data进行修改\n\t * @event {Function} error 失败回调\n\t */\n\texport default {\n\t\tname: 'UniClientdb',\n\t\tprops: {\n\t\t\toptions: {\n\t\t\t\ttype: [Object, Array],\n\t\t\t\tdefault () {\n\t\t\t\t\treturn {}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcollection: {\n\t\t\t\ttype: String,\n\t\t\t\tdefault: ''\n\t\t\t},\n\t\t\taction: {\n\t\t\t\ttype: String,\n\t\t\t\tdefault: ''\n\t\t\t},\n\t\t\tfield: {\n\t\t\t\ttype: String,\n\t\t\t\tdefault: ''\n\t\t\t},\n\t\t\tpageData: {\n\t\t\t\ttype: String,\n\t\t\t\tdefault: 'add'\n\t\t\t},\n\t\t\tpageCurrent: {\n\t\t\t\ttype: Number,\n\t\t\t\tdefault: 1\n\t\t\t},\n\t\t\tpageSize: {\n\t\t\t\ttype: Number,\n\t\t\t\tdefault: 20\n\t\t\t},\n\t\t\tgetcount: {\n\t\t\t\ttype: [Boolean, String],\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t\torderby: {\n\t\t\t\ttype: String,\n\t\t\t\tdefault: ''\n\t\t\t},\n\t\t\twhere: {\n\t\t\t\ttype: [String, Object],\n\t\t\t\tdefault: ''\n\t\t\t},\n\t\t\tgetone: {\n\t\t\t\ttype: [Boolean, String],\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t\tmanual: {\n\t\t\t\ttype: Boolean,\n\t\t\t\tdefault: false\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tloading: false,\n\t\t\t\tdataList: this.getone ? {} : [],\n\t\t\t\tpaginationInternal: {\n\t\t\t\t\tcurrent: this.pageCurrent,\n\t\t\t\t\tsize: this.pageSize,\n\t\t\t\t\tcount: 0\n\t\t\t\t},\n\t\t\t\terrorMessage: ''\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\tthis._isEnded = false\n\n\t\t\tthis.$watch(() => {\n\t\t\t\tvar al = []\n\t\t\t\tattrs.forEach(key => {\n\t\t\t\t\tal.push(this[key])\n\t\t\t\t})\n\t\t\t\treturn al\n\t\t\t}, (newValue, oldValue) => {\n\t\t\t\tthis.paginationInternal.pageSize = this.pageSize\n\n\t\t\t\tlet needReset = false\n\t\t\t\tfor (let i = 2; i < newValue.length; i++) {\n\t\t\t\t\tif (newValue[i] != oldValue[i]) {\n\t\t\t\t\t\tneedReset = true\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (needReset) {\n\t\t\t\t\tthis.clear()\n\t\t\t\t\tthis.reset()\n\t\t\t\t}\n\t\t\t\tif (newValue[0] != oldValue[0]) {\n\t\t\t\t\tthis.paginationInternal.current = this.pageCurrent\n\t\t\t\t}\n\n\t\t\t\tthis._execLoadData()\n\t\t\t})\n\n\t\t\t// #ifdef H5\n\t\t\tif (process.env.NODE_ENV === 'development') {\n\t\t\t\tthis._debugDataList = []\n\t\t\t\tif (!window.unidev) {\n\t\t\t\t\twindow.unidev = {\n\t\t\t\t\t\tclientDB: {\n\t\t\t\t\t\t\tdata: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tunidev.clientDB.data.push(this._debugDataList)\n\t\t\t}\n\t\t\t// #endif\n\n\t\t\t// #ifdef MP-TOUTIAO\n\t\t\tlet changeName\n\t\t\tlet events = this.$scope.dataset.eventOpts\n\t\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\t\tlet event = events[i]\n\t\t\t\tif (event[0].includes('^load')) {\n\t\t\t\t\tchangeName = event[1][0][0]\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (changeName) {\n\t\t\t\tlet parent = this.$parent\n\t\t\t\tlet maxDepth = 16\n\t\t\t\tthis._changeDataFunction = null\n\t\t\t\twhile (parent && maxDepth > 0) {\n\t\t\t\t\tlet fun = parent[changeName]\n\t\t\t\t\tif (fun && typeof fun === 'function') {\n\t\t\t\t\t\tthis._changeDataFunction = fun\n\t\t\t\t\t\tmaxDepth = 0\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tparent = parent.$parent\n\t\t\t\t\tmaxDepth--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// #endif\n\n\t\t\tif (!this.manual) {\n\t\t\t\tthis.loadData()\n\t\t\t}\n\t\t},\n\t\t// #ifdef H5\n\t\tbeforeDestroy() {\n\t\t\tif (process.env.NODE_ENV === 'development' && window.unidev) {\n\t\t\t\tvar cd = this._debugDataList\n\t\t\t\tvar dl = unidev.clientDB.data\n\t\t\t\tfor (var i = dl.length - 1; i >= 0; i--) {\n\t\t\t\t\tif (dl[i] === cd) {\n\t\t\t\t\t\tdl.splice(i, 1)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// #endif\n\t\tmethods: {\n\t\t\tloadData(args1, args2) {\n\t\t\t\tlet callback = null\n\t\t\t\tif (typeof args1 === 'object') {\n\t\t\t\t\tif (args1.clear) {\n\t\t\t\t\t\tthis.clear()\n\t\t\t\t\t\tthis.reset()\n\t\t\t\t\t}\n\t\t\t\t\tif (args1.current !== undefined) {\n\t\t\t\t\t\tthis.paginationInternal.current = args1.current\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof args2 === 'function') {\n\t\t\t\t\t\tcallback = args2\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof args1 === 'function') {\n\t\t\t\t\tcallback = args1\n\t\t\t\t}\n\n\t\t\t\tthis._execLoadData(callback)\n\t\t\t},\n\t\t\tloadMore() {\n\t\t\t\tif (this._isEnded) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis._execLoadData()\n\t\t\t},\n\t\t\trefresh() {\n\t\t\t\tthis.clear()\n\t\t\t\tthis._execLoadData()\n\t\t\t},\n\t\t\tclear() {\n\t\t\t\tthis._isEnded = false\n\t\t\t\tthis.dataList = []\n\t\t\t},\n\t\t\treset() {\n\t\t\t\tthis.paginationInternal.current = 1\n\t\t\t},\n\t\t\tremove(id, {\n\t\t\t\taction,\n\t\t\t\tcallback,\n\t\t\t\tconfirmTitle,\n\t\t\t\tconfirmContent\n\t\t\t} = {}) {\n\t\t\t\tif (!id || !id.length) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: confirmTitle || '提示',\n\t\t\t\t\tcontent: confirmContent || '是否删除该数据',\n\t\t\t\t\tshowCancel: true,\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (!res.confirm) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._execRemove(id, action, callback)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t_execLoadData(callback) {\n\t\t\t\tif (this.loading) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.loading = true\n\t\t\t\tthis.errorMessage = ''\n\n\t\t\t\tthis._getExec().then((res) => {\n\t\t\t\t\tthis.loading = false\n\t\t\t\t\tconst {\n\t\t\t\t\t\tdata,\n\t\t\t\t\t\tcount\n\t\t\t\t\t} = res.result\n\t\t\t\t\tthis._isEnded = data.length < this.pageSize\n\n\t\t\t\t\tcallback && callback(data, this._isEnded)\n\t\t\t\t\tthis._dispatchEvent(events.load, data)\n\n\t\t\t\t\tif (this.getone) {\n\t\t\t\t\t\tthis.dataList = data.length ? data[0] : undefined\n\t\t\t\t\t} else if (this.pageData === pageMode.add) {\n\t\t\t\t\t\tthis.dataList.push(...data)\n\t\t\t\t\t\tif (this.dataList.length) {\n\t\t\t\t\t\t\tthis.paginationInternal.current++\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.pageData === pageMode.replace) {\n\t\t\t\t\t\tthis.dataList = data\n\t\t\t\t\t\tthis.paginationInternal.count = count\n\t\t\t\t\t}\n\n\t\t\t\t\t// #ifdef H5\n\t\t\t\t\tif (process.env.NODE_ENV === 'development') {\n\t\t\t\t\t\tthis._debugDataList.length = 0\n\t\t\t\t\t\tthis._debugDataList.push(...JSON.parse(JSON.stringify(this.dataList)))\n\t\t\t\t\t}\n\t\t\t\t\t// #endif\n\t\t\t\t}).catch((err) => {\n\t\t\t\t\tthis.loading = false\n\t\t\t\t\tthis.errorMessage = err\n\t\t\t\t\tcallback && callback()\n\t\t\t\t\tthis.$emit(events.error, err)\n\t\t\t\t})\n\t\t\t},\n\t\t\t_getExec() {\n\t\t\t\tlet exec = db\n\t\t\t\tif (this.action) {\n\t\t\t\t\texec = exec.action(this.action)\n\t\t\t\t}\n\n\t\t\t\texec = exec.collection(this.collection)\n\n\t\t\t\tif (!(!this.where || !Object.keys(this.where).length)) {\n\t\t\t\t\texec = exec.where(this.where)\n\t\t\t\t}\n\t\t\t\tif (this.field) {\n\t\t\t\t\texec = exec.field(this.field)\n\t\t\t\t}\n\t\t\t\tif (this.orderby) {\n\t\t\t\t\texec = exec.orderBy(this.orderby)\n\t\t\t\t}\n\n\t\t\t\tconst {\n\t\t\t\t\tcurrent,\n\t\t\t\t\tsize\n\t\t\t\t} = this.paginationInternal\n\t\t\t\texec = exec.skip(size * (current - 1)).limit(size).get({\n\t\t\t\t\tgetCount: this.getcount\n\t\t\t\t})\n\n\t\t\t\treturn exec\n\t\t\t},\n\t\t\t_execRemove(id, action, callback) {\n\t\t\t\tif (!this.collection || !id) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tconst ids = Array.isArray(id) ? id : [id]\n\t\t\t\tif (!ids.length) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tuni.showLoading({\n\t\t\t\t\tmask: true\n\t\t\t\t})\n\n\t\t\t\tlet exec = db\n\t\t\t\tif (action) {\n\t\t\t\t\texec = exec.action(action)\n\t\t\t\t}\n\n\t\t\t\texec.collection(this.collection).where({\n\t\t\t\t\t_id: dbCmd.in(ids)\n\t\t\t\t}).remove().then((res) => {\n\t\t\t\t\tcallback && callback(res.result)\n\t\t\t\t\tif (this.pageData === pageMode.replace) {\n\t\t\t\t\t\tthis.refresh()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.removeData(ids)\n\t\t\t\t\t}\n\t\t\t\t}).catch((err) => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\tcontent: err.message,\n\t\t\t\t\t\tshowCancel: false\n\t\t\t\t\t})\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t})\n\t\t\t},\n\t\t\tremoveData(ids) {\n\t\t\t\tlet il = ids.slice(0)\n\t\t\t\tlet dl = this.dataList\n\t\t\t\tfor (let i = dl.length - 1; i >= 0; i--) {\n\t\t\t\t\tlet index = il.indexOf(dl[i]._id)\n\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\tdl.splice(i, 1)\n\t\t\t\t\t\til.splice(index, 1)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t_dispatchEvent(type, data) {\n\t\t\t\tif (this._changeDataFunction) {\n\t\t\t\t\tthis._changeDataFunction(data, this._isEnded)\n\t\t\t\t} else {\n\t\t\t\t\tthis.$emit(type, data, this._isEnded)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n"],"sourceRoot":""}